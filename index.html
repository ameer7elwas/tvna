<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TvNa - تيڤي نا - Ameer_7elwas</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tajawal', sans-serif;
        }

        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #f72585;
            --success: #4cc9f0;
            --warning: #ff9e00;
            --danger: #e74c3c;
            --dark: #0a0a0a;
            --darker: #121212;
            --light: #f8f9fa;
            --gray: #6c757d;
            --gray-light: #e9ecef;
            --premium: linear-gradient(135deg, #ff9e00, #ff6b35);
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --shadow-light: 0 8px 32px rgba(0, 0, 0, 0.1);
            --shadow-medium: 0 12px 40px rgba(0, 0, 0, 0.15);
            --shadow-heavy: 0 20px 60px rgba(0, 0, 0, 0.3);
            --gradient-bg: linear-gradient(135deg, var(--darker), var(--dark));
            --gradient-card: linear-gradient(135deg, rgba(67, 97, 238, 0.1), rgba(58, 12, 163, 0.1));
        }

        body {
            background: var(--gradient-bg);
            color: white;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            font-weight: 400;
            line-height: 1.6;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(67, 97, 238, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(247, 37, 133, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(58, 12, 163, 0.1) 0%, transparent 50%);
            z-index: -1;
            animation: backgroundShift 20s ease-in-out infinite;
        }

        @keyframes backgroundShift {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(2deg); }
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--darker);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary);
        }

        /* Loading Animation */
        .page-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--darker);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 1;
            transition: opacity 0.5s ease;
        }

        .page-loader.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loader-content {
            text-align: center;
        }

        .loader-logo {
            width: 80px;
            height: 80px;
            background: var(--premium);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin: 0 auto 1rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .loader-text {
            font-size: 1.5rem;
            font-weight: 700;
            background: var(--premium);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .loader-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(67, 97, 238, 0.3);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 1rem auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Header Enhanced */
        header {
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow-medium);
            border-bottom: 1px solid var(--glass-border);
            transition: all 0.3s ease;
        }

        header.scrolled {
            padding: 0.5rem 2rem;
            background: rgba(10, 10, 10, 0.98);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        .logo-icon {
            width: 55px;
            height: 55px;
            background: var(--premium);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: var(--shadow-light);
            position: relative;
            overflow: hidden;
        }

        .logo-icon::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            50% { transform: translateX(100%) translateY(100%) rotate(45deg); }
            100% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
        }

        .logo-text {
            font-size: 2rem;
            font-weight: 900;
            background: var(--premium);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(255, 158, 0, 0.5);
        }

        .nav-links {
            display: flex;
            gap: 0.5rem;
            background: var(--glass);
            padding: 0.5rem;
            border-radius: 50px;
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
        }

        .nav-link {
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            white-space: nowrap;
        }

        .nav-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }

        .nav-link:hover::before {
            left: 100%;
        }

        .nav-link:hover, .nav-link.active {
            background: var(--premium);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow-light);
        }

        .user-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .search-container {
            position: relative;
            display: flex;
            align-items: center;
        }

        .search-input {
            width: 0;
            padding: 0.8rem;
            border: none;
            border-radius: 25px;
            background: var(--glass);
            color: white;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
        }

        .search-input.active {
            width: 250px;
            padding-right: 3rem;
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .action-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--glass);
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            position: relative;
            overflow: hidden;
        }

        .action-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            transform: translate(-50%, -50%);
            transition: all 0.3s ease;
            border-radius: 50%;
        }

        .action-btn:hover::before {
            width: 100px;
            height: 100px;
        }

        .action-btn:hover {
            background: var(--primary);
            transform: translateY(-3px);
            box-shadow: var(--shadow-light);
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            overflow: hidden;
            border: 2px solid var(--primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--glass);
            font-size: 1.2rem;
            transition: all 0.3s ease;
            position: relative;
        }

        .user-avatar:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(67, 97, 238, 0.5);
        }

        .user-avatar.logged-in {
            background: var(--premium);
            border-color: var(--warning);
        }

        /* Notification Badge */
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-5px); }
            60% { transform: translateY(-3px); }
        }

        /* Connection Status */
        .connection-status {
            position: fixed;
            top: 80px;
            right: 20px;
            background: var(--glass);
            backdrop-filter: blur(20px);
            padding: 0.8rem 1.2rem;
            border-radius: 15px;
            border: 1px solid var(--glass-border);
            z-index: 1001;
            min-width: 250px;
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateX(100%);
        }

        .connection-status.show {
            opacity: 1;
            transform: translateX(0);
        }

        .connection-status.connected {
            border-color: var(--success);
            background: linear-gradient(135deg, rgba(76, 201, 240, 0.1), rgba(40, 167, 69, 0.1));
        }

        .connection-status.connecting {
            border-color: var(--warning);
            background: linear-gradient(135deg, rgba(255, 158, 0, 0.1), rgba(255, 107, 53, 0.1));
        }

        .connection-status.error {
            border-color: var(--danger);
            background: linear-gradient(135deg, rgba(231, 76, 60, 0.1), rgba(220, 53, 69, 0.1));
        }

        /* Hero Section Enhanced */
        .hero {
            padding: 4rem 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            gap: 2rem;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(circle at center, rgba(67, 97, 238, 0.1) 0%, transparent 50%);
            animation: heroRotate 20s linear infinite;
        }

        @keyframes heroRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .welcome-card {
            background: var(--gradient-card);
            backdrop-filter: blur(20px);
            padding: 3rem;
            border-radius: 30px;
            max-width: 900px;
            width: 100%;
            box-shadow: var(--shadow-heavy);
            position: relative;
            overflow: hidden;
            border: 1px solid var(--glass-border);
            z-index: 1;
        }

        .welcome-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.5), transparent);
        }

        .welcome-title {
            font-size: 3rem;
            margin-bottom: 1rem;
            position: relative;
            z-index: 2;
            font-weight: 900;
            background: var(--premium);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(255, 158, 0, 0.3);
        }

        .welcome-subtitle {
            font-size: 1.3rem;
            opacity: 0.9;
            margin-bottom: 2.5rem;
            position: relative;
            z-index: 2;
            font-weight: 400;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            width: 100%;
            position: relative;
            z-index: 2;
        }

        .stat-card {
            background: var(--glass);
            backdrop-filter: blur(15px);
            border: 1px solid var(--glass-border);
            padding: 2rem 1.5rem;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s ease;
        }

        .stat-card:hover::before {
            left: 100%;
        }

        .stat-card:hover {
            transform: translateY(-10px);
            background: rgba(67, 97, 238, 0.15);
            box-shadow: var(--shadow-medium);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            background: var(--premium);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-label {
            font-size: 1rem;
            opacity: 0.8;
            font-weight: 500;
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .quick-action-btn {
            padding: 1rem 2rem;
            border-radius: 50px;
            background: var(--glass);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            color: white;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }

        .quick-action-btn:hover {
            background: var(--primary);
            transform: translateY(-3px);
            box-shadow: var(--shadow-light);
        }

        .quick-action-btn.premium {
            background: var(--premium);
        }

        /* Content Sections Enhanced */
        .section {
            padding: 3rem 2rem;
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 3rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .section-title-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .section-icon {
            width: 60px;
            height: 60px;
            background: var(--premium);
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            box-shadow: var(--shadow-light);
        }

        .section-title {
            font-size: 2.2rem;
            font-weight: 800;
            background: var(--premium);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .section-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .live-badge {
            background: linear-gradient(45deg, var(--accent), #b5179e);
            padding: 0.5rem 1.5rem;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            animation: pulse 2s infinite;
        }

        .live-badge::before {
            content: '';
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        .view-toggle {
            display: flex;
            background: var(--glass);
            border-radius: 10px;
            padding: 0.3rem;
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
        }

        .view-toggle-btn {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .view-toggle-btn.active {
            background: var(--primary);
            color: white;
        }

        /* Advertisement Carousel Enhanced */
        .ads-carousel {
            position: relative;
            height: 400px;
            overflow: hidden;
            border-radius: 25px;
            margin-bottom: 4rem;
            box-shadow: var(--shadow-heavy);
            cursor: pointer;
        }

        .ad-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            padding: 3rem;
            opacity: 0;
            transition: all 1s ease;
            transform: scale(1.1);
        }

        .ad-slide.active {
            opacity: 1;
            transform: scale(1);
        }

        .ad-slide::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(
                135deg,
                rgba(0,0,0,0.1) 0%,
                rgba(0,0,0,0.3) 40%,
                rgba(0,0,0,0.8) 100%
            );
        }

        .ad-content {
            position: relative;
            z-index: 2;
            max-width: 600px;
        }

        .ad-badge {
            background: var(--accent);
            padding: 0.5rem 1.2rem;
            border-radius: 50px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            display: inline-block;
            font-weight: 700;
        }

        .ad-title {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: var(--premium);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
        }

        .ad-desc {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .ad-link {
            display: inline-flex;
            align-items: center;
            gap: 0.8rem;
            background: var(--glass);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            border-radius: 50px;
            text-decoration: none;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
            border: 1px solid var(--glass-border);
        }

        .ad-link:hover {
            background: var(--primary);
            transform: translateY(-3px);
            box-shadow: var(--shadow-light);
        }

        .carousel-indicators {
            position: absolute;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 0.8rem;
            z-index: 3;
        }

        .carousel-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.4);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .carousel-indicator.active {
            background: white;
            transform: scale(1.2);
        }

        .carousel-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            background: var(--glass);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 3;
        }

        .carousel-nav:hover {
            background: var(--primary);
            transform: translateY(-50%) scale(1.1);
        }

        .carousel-nav.prev {
            left: 2rem;
        }

        .carousel-nav.next {
            right: 2rem;
        }

        /* Channels Grid Enhanced */
        .channels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .channel-card {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            overflow: hidden;
            box-shadow: var(--shadow-medium);
            transition: all 0.4s ease;
            position: relative;
            border: 1px solid var(--glass-border);
            cursor: pointer;
        }

        .channel-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(67, 97, 238, 0.1), rgba(58, 12, 163, 0.1));
            opacity: 0;
            transition: all 0.3s ease;
        }

        .channel-card:hover::before {
            opacity: 1;
        }

        .channel-card:hover {
            transform: translateY(-15px) scale(1.02);
            box-shadow: var(--shadow-heavy);
            border-color: var(--primary);
        }

        .channel-header {
            position: relative;
            height: 200px;
            overflow: hidden;
        }

        .channel-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .channel-card:hover .channel-image {
            transform: scale(1.1);
        }

        .channel-badges {
            position: absolute;
            top: 1rem;
            right: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .channel-badge {
            background: var(--premium);
            color: white;
            padding: 0.4rem 1rem;
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: 700;
            backdrop-filter: blur(10px);
        }

        .channel-badge.live {
            background: linear-gradient(45deg, var(--accent), #b5179e);
            animation: pulse 2s infinite;
        }

        .channel-badge.premium {
            background: var(--premium);
        }

        .channel-badge.hd {
            background: linear-gradient(45deg, var(--success), #06d6a0);
        }

        .channel-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(transparent 60%, rgba(0,0,0,0.8));
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .channel-card:hover .channel-overlay {
            opacity: 1;
        }

        .play-overlay {
            width: 80px;
            height: 80px;
            background: var(--glass);
            backdrop-filter: blur(10px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            border: 2px solid var(--glass-border);
            transition: all 0.3s ease;
        }

        .play-overlay:hover {
            background: var(--primary);
            transform: scale(1.1);
        }

        .channel-content {
            padding: 2rem;
        }

        .channel-name {
            font-size: 1.4rem;
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-weight: 700;
        }

        .channel-category {
            background: rgba(67, 97, 238, 0.2);
            padding: 0.3rem 1rem;
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .channel-desc {
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 1.5rem;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .channel-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .channel-actions {
            display: flex;
            gap: 0.8rem;
        }

        .channel-action-btn {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.8rem;
            border-radius: 12px;
            background: var(--glass);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 600;
            border: 1px solid var(--glass-border);
        }

        .channel-action-btn:hover {
            background: var(--primary);
            transform: translateY(-2px);
        }

        .channel-action-btn.play-btn {
            background: var(--premium);
            flex: 2;
        }

        .channel-action-btn.play-btn:hover {
            background: linear-gradient(135deg, var(--warning), #ff6b35);
        }

        .channel-action-btn.favorite.active {
            background: var(--accent);
            color: white;
        }

        /* Filters and Search */
        .filters-container {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--glass);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
        }

        .filter-select {
            background: transparent;
            border: none;
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
            min-width: 120px;
        }

        .filter-select option {
            background: var(--darker);
            color: white;
        }

        .sort-toggle {
            display: flex;
            gap: 0.3rem;
            background: var(--glass);
            padding: 0.3rem;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
        }

        .sort-btn {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .sort-btn.active {
            background: var(--primary);
            color: white;
        }

        /* Modal Enhanced */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: var(--gradient-card);
            backdrop-filter: blur(30px);
            border-radius: 25px;
            width: 90%;
            max-width: 500px;
            padding: 3rem;
            box-shadow: var(--shadow-heavy);
            position: relative;
            border: 1px solid var(--glass-border);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .close-modal {
            position: absolute;
            top: 1.5rem;
            left: 1.5rem;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--accent);
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: var(--glass);
        }

        .close-modal:hover {
            background: var(--accent);
            color: white;
            transform: scale(1.1);
        }

        .modal-title {
            text-align: center;
            margin-bottom: 2.5rem;
            font-size: 2.2rem;
            background: var(--premium);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
        }

        .input-group {
            margin-bottom: 2rem;
            position: relative;
        }

        .input-group label {
            display: block;
            margin-bottom: 0.8rem;
            font-size: 1rem;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
        }

        .input-group input {
            width: 100%;
            padding: 1rem 1.5rem;
            border-radius: 15px;
            border: 1px solid var(--glass-border);
            background: var(--glass);
            color: white;
            font-size: 1rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }

        .input-group input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .modal-btn {
            width: 100%;
            padding: 1.2rem;
            border-radius: 15px;
            border: none;
            background: var(--premium);
            color: white;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }

        .modal-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-light);
            background: linear-gradient(135deg, var(--warning), #ff6b35);
        }

        .modal-footer {
            text-align: center;
            margin-top: 2rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .modal-footer a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
        }

        .modal-footer a:hover {
            color: var(--accent);
        }

        /* Video Player Enhanced */
        .video-player {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: black;
            z-index: 3000;
        }

        .video-player.show {
            display: block;
        }

        #player {
            width: 100%;
            height: 100%;
            background: black;
        }

        .player-controls {
            position: absolute;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            z-index: 3001;
        }

        .player-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--glass);
            backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid var(--glass-border);
        }

        .player-btn:hover {
            background: var(--primary);
            transform: scale(1.1);
        }

        .player-info {
            position: absolute;
            top: 2rem;
            left: 2rem;
            background: var(--glass);
            backdrop-filter: blur(20px);
            padding: 1rem 1.5rem;
            border-radius: 15px;
            border: 1px solid var(--glass-border);
            z-index: 3001;
        }

        .player-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .player-category {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 2rem;
            right: 2rem;
            z-index: 4000;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .toast {
            background: var(--glass);
            backdrop-filter: blur(20px);
            padding: 1rem 1.5rem;
            border-radius: 15px;
            border: 1px solid var(--glass-border);
            display: flex;
            align-items: center;
            gap: 1rem;
            min-width: 300px;
            transform: translateX(400px);
            transition: all 0.3s ease;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            border-color: var(--success);
        }

        .toast.error {
            border-color: var(--danger);
        }

        .toast.warning {
            border-color: var(--warning);
        }

        .toast-icon {
            font-size: 1.2rem;
        }

        .toast.success .toast-icon {
            color: var(--success);
        }

        .toast.error .toast-icon {
            color: var(--danger);
        }

        .toast.warning .toast-icon {
            color: var(--warning);
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 700;
            margin-bottom: 0.2rem;
        }

        .toast-message {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .toast-close {
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.3s ease;
        }

        .toast-close:hover {
            opacity: 1;
        }

        /* Footer Enhanced */
        footer {
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            padding: 4rem 2rem 2rem;
            margin-top: 6rem;
            border-top: 1px solid var(--glass-border);
            position: relative;
        }

        footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--primary), transparent);
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 3rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .footer-col h3 {
            font-size: 1.5rem;
            margin-bottom: 2rem;
            background: var(--premium);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: inline-block;
            font-weight: 800;
        }

        .footer-col p {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 1rem;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.5rem 0;
            font-weight: 500;
        }

        .footer-links a:hover {
            color: var(--primary);
            transform: translateX(10px);
        }

        .social-links {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .social-link {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--glass);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            transition: all 0.3s ease;
            border: 1px solid var(--glass-border);
            text-decoration: none;
            color: white;
        }

        .social-link:hover {
            background: var(--primary);
            transform: translateY(-5px);
            box-shadow: var(--shadow-light);
        }

        .newsletter-form {
            display: flex;
            margin-top: 1.5rem;
            gap: 0.5rem;
        }

        .newsletter-input {
            flex: 1;
            padding: 1rem;
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            background: var(--glass);
            color: white;
            backdrop-filter: blur(10px);
        }

        .newsletter-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .newsletter-btn {
            background: var(--primary);
            border: none;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }

        .newsletter-btn:hover {
            background: var(--secondary);
            transform: scale(1.05);
        }

        .copyright {
            text-align: center;
            padding-top: 3rem;
            margin-top: 3rem;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Responsive Design Enhanced */
        @media (max-width: 1200px) {
            .channels-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }

        @media (max-width: 992px) {
            .section {
                padding: 2rem 1rem;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .welcome-title {
                font-size: 2.5rem;
            }
        }

        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 1.5rem;
                padding: 1rem;
            }
            
            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
                width: 100%;
            }
            
            .hero {
                padding: 2rem 1rem;
            }
            
            .welcome-card {
                padding: 2rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .ad-slide {
                padding: 2rem 1rem;
            }
            
            .ad-title {
                font-size: 2rem;
            }
            
            .filters-container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .channels-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                margin: 1rem;
                padding: 2rem;
            }
        }

        @media (max-width: 480px) {
            .logo-text {
                font-size: 1.5rem;
            }
            
            .nav-link {
                padding: 0.6rem 1rem;
                font-size: 0.9rem;
            }
            
            .welcome-title {
                font-size: 2rem;
            }
            
            .section-title {
                font-size: 1.8rem;
            }
            
            .quick-actions {
                flex-direction: column;
                width: 100%;
            }
            
            .quick-action-btn {
                width: 100%;
                justify-content: center;
            }
            
            .toast {
                min-width: auto;
                margin: 0 1rem;
            }
        }

        /* Animation Classes */
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .slide-in-left {
            animation: slideInLeft 0.6s ease-out;
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide-in-right {
            animation: slideInRight 0.6s ease-out;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Loading States */
        .loading-skeleton {
            background: linear-gradient(90deg, 
                rgba(255,255,255,0.1) 25%, 
                rgba(255,255,255,0.2) 50%, 
                rgba(255,255,255,0.1) 75%
            );
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .skeleton-card {
            background: var(--glass);
            border-radius: 25px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .skeleton-header {
            height: 200px;
            border-radius: 20px;
            margin-bottom: 1rem;
        }

        .skeleton-title {
            height: 24px;
            width: 70%;
            border-radius: 12px;
            margin-bottom: 0.5rem;
        }

        .skeleton-text {
            height: 16px;
            width: 90%;
            border-radius: 8px;
            margin-bottom: 0.5rem;
        }

        .skeleton-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .skeleton-btn {
            flex: 1;
            height: 40px;
            border-radius: 10px;
        }

        /* Tab Content Animation */
        .tab-content {
            display: none;
            animation: tabFadeIn 0.3s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes tabFadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Search Results */
        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 15px;
            margin-top: 0.5rem;
            max-height: 400px;
            overflow-y: auto;
            z-index: 1001;
        }

        .search-result-item {
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .search-result-item:hover {
            background: rgba(67, 97, 238, 0.2);
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        .search-result-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .search-result-content {
            flex: 1;
        }

        .search-result-title {
            font-weight: 600;
            margin-bottom: 0.2rem;
        }

        .search-result-category {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.6);
        }

        /* Empty States */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: rgba(255, 255, 255, 0.6);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 2rem;
            color: rgba(255, 255, 255, 0.3);
        }

        .empty-state-title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .empty-state-message {
            font-size: 1rem;
            line-height: 1.6;
            max-width: 400px;
            margin: 0 auto;
        }

        /* Utility Classes */
        .text-gradient {
            background: var(--premium);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .glass-bg {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
        }

        .premium-bg {
            background: var(--premium);
        }

        .shadow-light {
            box-shadow: var(--shadow-light);
        }

        .shadow-medium {
            box-shadow: var(--shadow-medium);
        }

        .shadow-heavy {
            box-shadow: var(--shadow-heavy);
        }

        .rounded-xl {
            border-radius: 20px;
        }

        .rounded-2xl {
            border-radius: 25px;
        }

        .rounded-3xl {
            border-radius: 30px;
        }
    </style>
</head>
<body>
    <!-- Page Loader -->
    <div class="page-loader" id="pageLoader">
        <div class="loader-content">
            <div class="loader-logo">
                <i class="fas fa-tv"></i>
            </div>
            <div class="loader-text">TvNa تيڤي نا</div>
            <div class="loader-spinner"></div>
        </div>
    </div>

    <!-- Connection Status -->
    <div class="connection-status" id="connectionStatus">
        <div style="display: flex; align-items: center; gap: 10px;">
            <div class="loading-spinner"></div>
            <span>جاري الاتصال بقاعدة البيانات...</span>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Header -->
    <header id="header">
        <div class="logo" id="homeBtn">
            <div class="logo-icon">
                <i class="fas fa-tv"></i>
            </div>
            <h1 class="logo-text">TvNa تيڤي نا</h1>
        </div>
        
        <nav class="nav-links">
            <div class="nav-link active" data-tab="home">
                <i class="fas fa-home"></i>
                الرئيسية
            </div>
            <div class="nav-link" data-tab="channels">
                <i class="fas fa-tv"></i>
                القنوات
            </div>
            <div class="nav-link" data-tab="categories">
                <i class="fas fa-list"></i>
                التصنيفات
            </div>
            <div class="nav-link" data-tab="favorites">
                <i class="fas fa-heart"></i>
                المفضلة
            </div>
            <div class="nav-link" data-tab="news">
                <i class="fas fa-newspaper"></i>
                الأخبار
            </div>
        </nav>
        
        <div class="user-actions">
            <div class="search-container">
                <input type="text" class="search-input" id="searchInput" placeholder="ابحث عن القنوات...">
                <div class="action-btn" id="searchBtn">
                    <i class="fas fa-search"></i>
                </div>
                <div class="search-results" id="searchResults"></div>
            </div>
            
            <div class="action-btn" id="notificationBtn">
                <i class="fas fa-bell"></i>
                <div class="notification-badge">3</div>
            </div>
            
            <div class="action-btn" id="themeBtn">
                <i class="fas fa-moon"></i>
            </div>
            
            <div class="user-avatar" id="loginBtn">
                <i class="fas fa-user"></i>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="mainContent">
        <!-- Home Tab -->
        <section id="homeTab" class="tab-content active">
            <div class="hero">
                <div class="welcome-card fade-in">
                    <h2 class="welcome-title" id="welcomeTitle">مرحباً بك في TvNa</h2>
                    <p class="welcome-subtitle" id="welcomeSubtitle">استمتع بأفضل تجربة مشاهدة مع القنوات المحلية والعالمية</p>
                    
                    <div class="stats-grid">
                        <div class="stat-card slide-in-left">
                            <div class="stat-icon">
                                <i class="fas fa-tv"></i>
                            </div>
                            <div class="stat-value" id="channelsCount">0</div>
                            <div class="stat-label">قناة تلفزيونية</div>
                        </div>
                        
                        <div class="stat-card slide-in-right">
                            <div class="stat-icon">
                                <i class="fas fa-heart"></i>
                            </div>
                            <div class="stat-value" id="favoritesCount">0</div>
                            <div class="stat-label">قناة مفضلة</div>
                        </div>
                    </div>

                    <div class="quick-actions">
                        <div class="quick-action-btn premium" id="upgradeBtn">
                            <i class="fas fa-crown"></i>
                            <span>ترقية للمميز</span>
                        </div>
                        <div class="quick-action-btn" data-tab="channels">
                            <i class="fas fa-play"></i>
                            <span>تصفح القنوات</span>
                        </div>
                        <div class="quick-action-btn" data-tab="news">
                            <i class="fas fa-newspaper"></i>
                            <span>آخر الأخبار</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-title-container">
                        <div class="section-icon">
                            <i class="fas fa-bullhorn"></i>
                        </div>
                        <h2 class="section-title">إعلانات TvNa التجارية</h2>
                    </div>
                    <div class="section-controls">
                        <div class="live-badge">مباشر</div>
                    </div>
                </div>
                
                <div class="ads-carousel" id="adsCarousel">
                    <!-- Ads will be loaded here -->
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-title-container">
                        <div class="section-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <h2 class="section-title">القنوات المميزة</h2>
                    </div>
                    <div class="section-controls">
                        <div class="view-toggle">
                            <div class="view-toggle-btn active" data-view="grid">
                                <i class="fas fa-th"></i>
                            </div>
                            <div class="view-toggle-btn" data-view="list">
                                <i class="fas fa-list"></i>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="channels-grid" id="featuredChannels">
                    <!-- Featured channels will be loaded here -->
                </div>
            </div>
        </section>

        <!-- Channels Tab -->
        <section id="channelsTab" class="tab-content">
            <div class="section">
                <div class="section-header">
                    <div class="section-title-container">
                        <div class="section-icon">
                            <i class="fas fa-tv"></i>
                        </div>
                        <h2 class="section-title">جميع القنوات</h2>
                    </div>
                    <div class="section-controls">
                        <div class="view-toggle">
                            <div class="view-toggle-btn active" data-view="grid">
                                <i class="fas fa-th"></i>
                            </div>
                            <div class="view-toggle-btn" data-view="list">
                                <i class="fas fa-list"></i>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="filters-container">
                    <div class="filter-group">
                        <i class="fas fa-filter"></i>
                        <select class="filter-select" id="categoryFilter">
                            <option value="">جميع التصنيفات</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <i class="fas fa-signal"></i>
                        <select class="filter-select" id="qualityFilter">
                            <option value="">جميع الجودات</option>
                            <option value="HD">عالي الوضوح HD</option>
                            <option value="FHD">فائق الوضوح FHD</option>
                            <option value="4K">دقة 4K</option>
                        </select>
                    </div>
                    
                    <div class="sort-toggle">
                        <div class="sort-btn active" data-sort="name">الاسم</div>
                        <div class="sort-btn" data-sort="popularity">الشعبية</div>
                        <div class="sort-btn" data-sort="rating">التقييم</div>
                    </div>
                </div>
                
                <div class="channels-grid" id="allChannels">
                    <!-- All channels will be loaded here -->
                </div>
            </div>
        </section>

        <!-- Categories Tab -->
        <section id="categoriesTab" class="tab-content">
            <div class="section">
                <div class="section-header">
                    <div class="section-title-container">
                        <div class="section-icon">
                            <i class="fas fa-list"></i>
                        </div>
                        <h2 class="section-title">التصنيفات</h2>
                    </div>
                </div>
                
                <div class="channels-grid" id="categoriesContent">
                    <!-- Categories will be loaded here -->
                </div>
            </div>
        </section>

        <!-- Favorites Tab -->
        <section id="favoritesTab" class="tab-content">
            <div class="section">
                <div class="section-header">
                    <div class="section-title-container">
                        <div class="section-icon">
                            <i class="fas fa-heart"></i>
                        </div>
                        <h2 class="section-title">قنواتي المفضلة</h2>
                    </div>
                    <div class="section-controls">
                        <div class="quick-action-btn" id="clearFavoritesBtn">
                            <i class="fas fa-trash"></i>
                            <span>مسح الكل</span>
                        </div>
                    </div>
                </div>
                
                <div class="channels-grid" id="favoritesContent">
                    <!-- Favorites will be loaded here -->
                </div>
            </div>
        </section>

        <!-- News Tab -->
        <section id="newsTab" class="tab-content">
            <div class="section">
                <div class="section-header">
                    <div class="section-title-container">
                        <div class="section-icon">
                            <i class="fas fa-newspaper"></i>
                        </div>
                        <h2 class="section-title">آخر الأخبار الرياضية</h2>
                    </div>
                    <div class="section-controls">
                        <div class="live-badge">مباشر</div>
                    </div>
                </div>
                
                <div class="channels-grid" id="newsContent">
                    <!-- News will be loaded here -->
                </div>
            </div>
        </section>
    </main>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <div class="close-modal" id="closeModal">
                <i class="fas fa-times"></i>
            </div>
            <h2 class="modal-title">تسجيل الدخول</h2>
            
            <div class="input-group">
                <label for="email">البريد الإلكتروني أو اسم المستخدم</label>
                <input type="text" id="email" placeholder="ادخل بريدك الإلكتروني أو اسم المستخدم">
            </div>
            
            <div class="input-group">
                <label for="password">كلمة المرور</label>
                <input type="password" id="password" placeholder="ادخل كلمة المرور">
            </div>
            
            <button class="modal-btn" id="submitLogin">دخول</button>
            
            <div class="modal-footer">
               
                </p>
            </div>
        </div>
    </div>

    <!-- Video Player -->
    <div class="video-player" id="videoPlayer">
        <div class="player-info">
            <div class="player-title" id="playerTitle">اسم القناة</div>
            <div class="player-category" id="playerCategory">التصنيف</div>
        </div>
        
        <video id="player" controls autoplay></video>
        
        <div class="player-controls">
            <div class="player-btn" id="playerFullscreen">
                <i class="fas fa-expand"></i>
            </div>
            <div class="player-btn" id="playerVolume">
                <i class="fas fa-volume-up"></i>
            </div>
            <div class="player-btn" id="closePlayer">
                <i class="fas fa-times"></i>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-grid">
            <div class="footer-col">
                <h3>TvNa تيڤي نا</h3>
                <p>منصة تلفزيونية شاملة تقدم أفضل القنوات المحلية والعالمية، والأخبار الرياضية، والبرامج الحصرية بجودة عالية وتجربة مستخدم متميزة.</p>
                <div class="social-links">
            
                    </a>
                </div>
            </div>
            
            <div class="footer-col">
                <h3>روابط سريعة</h3>
                <ul class="footer-links">
                    <li><a href="#" data-tab="home"><i class="fas fa-arrow-left"></i> الرئيسية</a></li>
                    <li><a href="#" data-tab="channels"><i class="fas fa-arrow-left"></i> القنوات</a></li>
                    <li><a href="#" data-tab="categories"><i class="fas fa-arrow-left"></i> التصنيفات</a></li>
                    <li><a href="#" data-tab="favorites"><i class="fas fa-arrow-left"></i> المفضلة</a></li>
                    <li><a href="#" data-tab="news"><i class="fas fa-arrow-left"></i> الأخبار</a></li>
                    <li><a href="#" id="premiumLink"><i class="fas fa-arrow-left"></i> العضوية المميزة</a></li>
                </ul>
            </div>
            
            <div class="footer-col">
                <h3>الدعم الفني</h3>
                <ul class="footer-links">
                    <li><a href="#"><i class="fas fa-arrow-left"></i> الأسئلة الشائعة</a></li>
                    <li><a href="#"><i class="fas fa-arrow-left"></i> سياسة الخصوصية</a></li>
                    <li><a href="#"><i class="fas fa-arrow-left"></i> شروط الاستخدام</a></li>
                    <li><a href="#"><i class="fas fa-arrow-left"></i> اتصل بنا</a></li>
                    <li><a href="#"><i class="fas fa-arrow-left"></i> الإبلاغ عن مشكلة</a></li>
                    <li><a href="#"><i class="fas fa-arrow-left"></i> مركز المساعدة</a></li>
                </ul>
            </div>
            
            <div class="footer-col">
                <h3>النشرة البريدية</h3>
                <p>اشترك في نشرتنا البريدية لتصلك آخر التحديثات والعروض الحصرية ومعلومات عن القنوات الجديدة</p>
                <form class="newsletter-form" id="newsletterForm">
                    <input type="email" class="newsletter-input" placeholder="بريدك الإلكتروني" required>
                    <button type="submit" class="newsletter-btn">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </form>
            </div>
        </div>
        
        <div class="copyright">
            © 2025 TvNa تيڤي نا. جميع الحقوق محفوظة. Ameer_7elwas
            <br>
            <small>  </small>
        </div>
    </footer>

    <script>
        // Enhanced TvNa JavaScript Application with Supabase Integration
        class TvNaApp {
            constructor() {
                // Supabase configuration
                this.SUPABASE_URL = 'https://vpvvjascwgivdjyyhzwp.supabase.co';
                this.SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZwdnZqYXNjd2dpdmRqeXloendwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MDYxMjYsImV4cCI6MjA2NTM4MjEyNn0.6AR2-MG4x9ugNTXe9jUqx-IwGEtj1m6MCYwQkTsSbUQ';
                
                // Application state
                this.currentUser = null;
                this.channels = [];
                this.ads = [];
                this.categories = [];
                this.favorites = this.loadFavoritesFromStorage();
                this.currentTab = 'home';
                this.currentSort = 'name';
                this.currentFilters = {
                    category: '',
                    quality: '',
                    search: ''
                };
                this.isLoading = false;
                this.isConnected = false;
                
                // UI elements
                this.elements = {
                    pageLoader: document.getElementById('pageLoader'),
                    connectionStatus: document.getElementById('connectionStatus'),
                    header: document.getElementById('header'),
                    loginBtn: document.getElementById('loginBtn'),
                    loginModal: document.getElementById('loginModal'),
                    closeModal: document.getElementById('closeModal'),
                    submitLogin: document.getElementById('submitLogin'),
                    videoPlayer: document.getElementById('videoPlayer'),
                    playerElement: document.getElementById('player'),
                    closePlayer: document.getElementById('closePlayer'),
                    themeBtn: document.getElementById('themeBtn'),
                    homeBtn: document.getElementById('homeBtn'),
                    searchBtn: document.getElementById('searchBtn'),
                    searchInput: document.getElementById('searchInput'),
                    searchResults: document.getElementById('searchResults'),
                    navLinks: document.querySelectorAll('.nav-link'),
                    tabContents: document.querySelectorAll('.tab-content'),
                    toastContainer: document.getElementById('toastContainer')
                };
                
                this.init();
            }
            
            async init() {
                try {
                    this.setupEventListeners();
                    await this.testConnection();
                    await this.loadAllData();
                    this.checkUserSession();
                    this.hideLoader();
                    this.animateElements();
                } catch (error) {
                    console.error('Application initialization failed:', error);
                    this.showConnectionStatus('error', 'فشل في تحميل التطبيق');
                    this.showToast('خطأ في تحميل التطبيق', 'error');
                }
            }

            // Enhanced Supabase API functions
            async supabaseRequest(endpoint, options = {}) {
                const url = `${this.SUPABASE_URL}/rest/v1/${endpoint}`;
                const headers = {
                    'apikey': this.SUPABASE_KEY,
                    'Authorization': `Bearer ${this.SUPABASE_KEY}`,
                    'Content-Type': 'application/json',
                    'Prefer': 'return=representation',
                    ...options.headers
                };

                try {
                    console.log(`Making request to: ${url}`, options);
                    
                    const response = await fetch(url, {
                        ...options,
                        headers
                    });

                    console.log(`Response status: ${response.status}`);

                    if (!response.ok) {
                        const errorText = await response.text();
                        console.error('Supabase error:', errorText);
                        throw new Error(`HTTP error! status: ${response.status}, message: ${errorText}`);
                    }

                    const text = await response.text();
                    const result = text ? JSON.parse(text) : null;
                    console.log('Supabase response:', result);
                    return result;
                } catch (error) {
                    console.error('Supabase request error:', error);
                    throw error;
                }
            }

            async testConnection() {
                try {
                    this.showConnectionStatus('connecting', 'جاري اختبار الاتصال بقاعدة البيانات...');
                    
                    const result = await this.supabaseRequest('channels?limit=1');
                    
                    this.isConnected = true;
                    this.showConnectionStatus('connected', '✅ متصل بقاعدة البيانات بنجاح');
                    
                    setTimeout(() => {
                        this.hideConnectionStatus();
                    }, 3000);
                    
                } catch (error) {
                    console.error('Connection test failed:', error);
                    this.isConnected = false;
                    this.showConnectionStatus('error', '❌ فشل الاتصال بقاعدة البيانات - استخدام البيانات المحلية');
                    
                    setTimeout(() => {
                        this.hideConnectionStatus();
                    }, 5000);
                }
            }

            showConnectionStatus(type, message) {
                const statusElement = this.elements.connectionStatus;
                statusElement.className = `connection-status ${type} show`;
                statusElement.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px;">
                        ${type === 'connecting' ? '<div class="loading-spinner"></div>' : ''}
                        <span>${message}</span>
                    </div>
                `;
            }

            hideConnectionStatus() {
                this.elements.connectionStatus.classList.remove('show');
            }

            async loadAllData() {
                try {
                    // Show loading state
                    this.isLoading = true;
                    
                    // Load data from Supabase
                    await Promise.all([
                        this.loadChannelsFromDB(),
                        this.loadCategoriesFromDB(),
                        this.loadAdsFromDB()
                    ]);
                    
                    this.updateStats();
                    this.renderAds();
                    this.renderFeaturedChannels();
                    this.renderAllChannels();
                    this.populateFilters();
                    
                    this.isLoading = false;
                    this.showToast('تم تحميل جميع البيانات بنجاح', 'success');
                    
                } catch (error) {
                    console.error('Error loading data:', error);
                    this.isLoading = false;
                    
                    // Fallback to mock data if database connection fails
                    this.loadMockData();
                    this.showToast('تم تحميل البيانات التجريبية (فشل الاتصال بقاعدة البيانات)', 'warning');
                }
            }

            async loadChannelsFromDB() {
                try {
                    const channels = await this.supabaseRequest('channels?select=*&order=order_index.asc.nullslast,name.asc');
                    
                    if (channels && channels.length > 0) {
                        this.channels = channels.map(channel => ({
                            id: channel.id,
                            name: channel.name,
                            nameAr: channel.name_ar || channel.name,
                            description: channel.description || '',
                            descriptionAr: channel.description_ar || channel.description || '',
                            category: channel.category,
                            imageUrl: channel.image_url || 'https://via.placeholder.com/400x300?text=' + encodeURIComponent(channel.name),
                            url: channel.url,
                            isPremium: channel.membership_type === 'premium' || channel.membership_type === 'vip',
                            isLive: channel.is_active,
                            quality: channel.quality || 'HD',
                            viewersCount: channel.viewers_count || 0,
                            rating: 4.5 + Math.random() * 0.5,
                            membershipType: channel.membership_type || 'free'
                        }));
                        
                        console.log('Loaded channels from database:', this.channels.length);
                    } else {
                        console.log('No channels found in database, using mock data');
                        this.loadMockChannels();
                    }
                } catch (error) {
                    console.error('Error loading channels from database:', error);
                    this.loadMockChannels();
                }
            }

            async loadCategoriesFromDB() {
                try {
                    const categories = await this.supabaseRequest('categories?select=*&order=order_index.asc,name.asc');
                    
                    if (categories && categories.length > 0) {
                        this.categories = categories.map(category => ({
                            id: category.id,
                            name: category.name,
                            nameAr: category.name_ar || category.name,
                            icon: this.getCategoryIcon(category.name),
                            isActive: category.is_active
                        }));
                        
                        console.log('Loaded categories from database:', this.categories.length);
                    } else {
                        console.log('No categories found in database, using mock data');
                        this.loadMockCategories();
                    }
                } catch (error) {
                    console.error('Error loading categories from database:', error);
                    this.loadMockCategories();
                }
            }

            async loadAdsFromDB() {
                try {
                    const ads = await this.supabaseRequest('advertisements?select=*&eq.is_active.true&order=created_at.desc');
                    
                    if (ads && ads.length > 0) {
                        this.ads = ads.map((ad, index) => ({
                            id: ad.id,
                            title: ad.title_ar || ad.title,
                            description: ad.description_ar || ad.description,
                            imageUrl: ad.image_url || 'https://images.unsplash.com/photo-1611162617474-5b21e879e113?w=800&h=400&fit=crop',
                            link: ad.link || '#premium',
                            isActive: index === 0
                        }));
                        
                        console.log('Loaded ads from database:', this.ads.length);
                    } else {
                        console.log('No ads found in database, using mock data');
                        this.loadMockAds();
                    }
                } catch (error) {
                    console.error('Error loading ads from database:', error);
                    this.loadMockAds();
                }
            }

            getCategoryIcon(categoryName) {
                const iconMap = {
                    'Sports': 'fas fa-futbol',
                    'News': 'fas fa-newspaper',
                    'Entertainment': 'fas fa-masks-theater',
                    'Movies': 'fas fa-film',
                    'Kids': 'fas fa-child',
                    'General': 'fas fa-tv',
                    'Music': 'fas fa-music',
                    'Documentary': 'fas fa-file-video'
                };
                return iconMap[categoryName] || 'fas fa-tv';
            }

            // Enhanced User authentication with better compatibility
            async authenticateUser(emailOrUsername, password) {
                try {
                    console.log('Attempting authentication for:', emailOrUsername);
                    
                    // First, try to find user by email or username using corrected query syntax
                    let users = null;
                    
                    if (emailOrUsername.includes('@')) {
                        // Search by email
                        users = await this.supabaseRequest(`users?email=eq.${emailOrUsername}&select=*`);
                    } else {
                        // Search by username
                        users = await this.supabaseRequest(`users?username=eq.${emailOrUsername}&select=*`);
                    }
                    
                    console.log('User query results:', users);
                    
                    if (users && users.length > 0) {
                        const user = users[0];
                        console.log('User found:', user);
                        
                        // Check if user has password_hash
                        if (!user.password_hash) {
                            console.error('User has no password hash');
                            return null;
                        }
                        
                        // Decode the stored password (base64 decoding)
                        let storedPassword;
                        try {
                            storedPassword = atob(user.password_hash);
                        } catch (error) {
                            console.error('Error decoding password:', error);
                            return null;
                        }
                        
                        console.log('Password check - provided:', password, 'stored:', storedPassword);
                        
                        if (password === storedPassword) {
                            console.log('Password matches! Logging in user.');
                            
                            // Update last login
                            try {
                                await this.supabaseRequest(`users?id=eq.${user.id}`, {
                                    method: 'PATCH',
                                    body: JSON.stringify({
                                        last_login_at: new Date().toISOString()
                                    })
                                });
                            } catch (error) {
                                console.error('Error updating last login:', error);
                            }
                            
                            const authenticatedUser = {
                                id: user.id,
                                username: user.username,
                                email: user.email,
                                phone: user.phone,
                                isPremium: user.membership_type === 'premium' || user.membership_type === 'vip',
                                membershipType: user.membership_type || 'free',
                                allowedChannels: user.allowed_channels || [],
                                joinDate: new Date(user.created_at),
                                avatar: user.profile_image,
                                isActive: user.is_active !== false
                            };
                            
                            console.log('Authenticated user object:', authenticatedUser);
                            return authenticatedUser;
                        } else {
                            console.log('Password does not match');
                        }
                    } else {
                        console.log('No user found with provided credentials');
                    }
                    
                    return null;
                } catch (error) {
                    console.error('Authentication error:', error);
                    console.log('Falling back to sample user authentication');
                    // Try to authenticate with sample users for demo
                    return this.authenticateWithSampleUsers(emailOrUsername, password);
                }
            }

            // Fallback authentication with sample users
            authenticateWithSampleUsers(emailOrUsername, password) {
                console.log('Authenticating with sample users - input:', emailOrUsername, password);
                
                const sampleUsers = [
                    {
                        id: 'sample1',
                        username: 'user1',
                        email: 'user1@example.com',
                        password: 'user123',
                        membershipType: 'free',
                        allowedChannels: []
                    },
                    {
                        id: 'sample2',
                        username: 'premium',
                        email: 'premium@example.com',
                        password: 'premium123',
                        membershipType: 'premium',
                        allowedChannels: []
                    },
                    {
                        id: 'sample3',
                        username: 'vip',
                        email: 'vip@example.com',
                        password: 'vip123',
                        membershipType: 'vip',
                        allowedChannels: []
                    }
                ];

                const user = sampleUsers.find(u => 
                    (u.username === emailOrUsername || u.email === emailOrUsername) && 
                    u.password === password
                );

                if (user) {
                    console.log('Sample user found:', user);
                    return {
                        id: user.id,
                        username: user.username,
                        email: user.email,
                        isPremium: user.membershipType === 'premium' || user.membershipType === 'vip',
                        membershipType: user.membershipType,
                        allowedChannels: user.allowedChannels,
                        joinDate: new Date(),
                        avatar: null,
                        isActive: true
                    };
                }

                console.log('No sample user found');
                return null;
            }

            // Favorites management with database
            async toggleFavorite(channel) {
                if (!this.currentUser) {
                    this.showLoginModal();
                    return;
                }
                
                const index = this.favorites.findIndex(f => f.id === channel.id);
                
                try {
                    if (index === -1) {
                        // Add to favorites
                        this.favorites.push(channel);
                        
                        // Save to database
                        try {
                            await this.supabaseRequest('favorites', {
                                method: 'POST',
                                body: JSON.stringify({
                                    user_id: this.currentUser.id,
                                    channel_id: channel.id
                                })
                            });
                        } catch (error) {
                            console.error('Error saving favorite to database:', error);
                        }
                        
                        this.showToast(`تم إضافة ${channel.nameAr} إلى المفضلة`, 'success');
                    } else {
                        // Remove from favorites
                        this.favorites.splice(index, 1);
                        
                        // Remove from database
                        try {
                            await this.supabaseRequest(`favorites?user_id=eq.${this.currentUser.id}&channel_id=eq.${channel.id}`, {
                                method: 'DELETE'
                            });
                        } catch (error) {
                            console.error('Error removing favorite from database:', error);
                        }
                        
                        this.showToast(`تم إزالة ${channel.nameAr} من المفضلة`, 'warning');
                    }
                    
                    this.saveFavoritesToStorage();
                    this.updateStats();
                    this.updateFavoriteButtons();
                    
                    if (this.currentTab === 'favorites') {
                        this.renderFavorites();
                    }
                } catch (error) {
                    console.error('Error updating favorites:', error);
                    this.showToast('خطأ في تحديث المفضلة', 'error');
                }
            }

            async loadUserFavorites() {
                if (!this.currentUser) return;
                
                try {
                    const favorites = await this.supabaseRequest(`favorites?select=channel_id&eq.user_id.${this.currentUser.id}`);
                    
                    if (favorites && favorites.length > 0) {
                        // Get favorite channels
                        const favoriteChannelIds = favorites.map(f => f.channel_id);
                        this.favorites = this.channels.filter(c => favoriteChannelIds.includes(c.id));
                        this.saveFavoritesToStorage();
                        this.updateStats();
                    }
                } catch (error) {
                    console.error('Error loading user favorites:', error);
                }
            }
            
            setupEventListeners() {
                // Login modal events
                this.elements.loginBtn.addEventListener('click', () => this.showLoginModal());
                this.elements.closeModal.addEventListener('click', () => this.hideLoginModal());
                this.elements.submitLogin.addEventListener('click', () => this.handleLogin());
                
                // Video player events
                this.elements.closePlayer.addEventListener('click', () => this.closeVideoPlayer());
                document.getElementById('playerFullscreen').addEventListener('click', () => this.toggleFullscreen());
                document.getElementById('playerVolume').addEventListener('click', () => this.toggleMute());
                
                // Navigation events
                this.elements.homeBtn.addEventListener('click', () => this.showTab('home'));
                this.elements.navLinks.forEach(link => {
                    link.addEventListener('click', () => {
                        const tab = link.getAttribute('data-tab');
                        this.showTab(tab);
                    });
                });
                
                // Quick action buttons
                document.querySelectorAll('.quick-action-btn[data-tab]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const tab = btn.getAttribute('data-tab');
                        this.showTab(tab);
                    });
                });
                
                // Search functionality
                this.elements.searchBtn.addEventListener('click', () => this.toggleSearch());
                this.elements.searchInput.addEventListener('input', (e) => this.handleSearch(e.target.value));
                this.elements.searchInput.addEventListener('focus', () => this.showSearchResults());
                this.elements.searchInput.addEventListener('blur', () => {
                    setTimeout(() => this.hideSearchResults(), 200);
                });
                
                // Theme toggle
                this.elements.themeBtn.addEventListener('click', () => this.toggleTheme());
                
                // Filters and sorting
                document.getElementById('categoryFilter').addEventListener('change', (e) => {
                    this.currentFilters.category = e.target.value;
                    this.filterChannels();
                });
                
                document.getElementById('qualityFilter').addEventListener('change', (e) => {
                    this.currentFilters.quality = e.target.value;
                    this.filterChannels();
                });
                
                document.querySelectorAll('.sort-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.currentSort = btn.getAttribute('data-sort');
                        this.updateSortButtons();
                        this.sortChannels();
                    });
                });
                
                // View toggle
                document.querySelectorAll('.view-toggle-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('.view-toggle-btn').forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        this.updateView(btn.getAttribute('data-view'));
                    });
                });
                
                // Header scroll effect
                window.addEventListener('scroll', () => {
                    if (window.scrollY > 100) {
                        this.elements.header.classList.add('scrolled');
                    } else {
                        this.elements.header.classList.remove('scrolled');
                    }
                });
                
                // Footer links
                document.querySelectorAll('.footer-links a[data-tab]').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const tab = link.getAttribute('data-tab');
                        this.showTab(tab);
                    });
                });
                
                // Newsletter form
                document.getElementById('newsletterForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleNewsletterSubscription(e);
                });
                
                // Clear favorites
                document.getElementById('clearFavoritesBtn').addEventListener('click', () => {
                    this.clearAllFavorites();
                });
                
                // Premium upgrade
                document.getElementById('upgradeBtn').addEventListener('click', () => {
                    this.showPremiumModal();
                });
                
                // Modal outside click
                this.elements.loginModal.addEventListener('click', (e) => {
                    if (e.target === this.elements.loginModal) {
                        this.hideLoginModal();
                    }
                });
                
                // Keyboard shortcuts
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        this.hideLoginModal();
                        this.closeVideoPlayer();
                        this.hideSearchResults();
                    }
                    if (e.ctrlKey && e.key === 'k') {
                        e.preventDefault();
                        this.toggleSearch();
                    }
                });
            }
            
            loadMockData() {
                this.loadMockChannels();
                this.loadMockCategories();
                this.loadMockAds();
                
                this.updateStats();
                this.renderAds();
                this.renderFeaturedChannels();
                this.renderAllChannels();
                this.populateFilters();
            }

            loadMockChannels() {
                this.channels = [
                    {
                        id: '1',
                        name: 'Al Jazeera',
                        nameAr: 'قناة الجزيرة',
                        description: 'قناة إخبارية عالمية',
                        descriptionAr: 'قناة إخبارية عالمية تقدم آخر الأخبار والتقارير',
                        category: 'News',
                        imageUrl: 'https://images.unsplash.com/photo-1611273426858-450d8e3c9fce?w=400&h=300&fit=crop',
                        url: 'https://live-hls-web-aje.getaj.net/AJE/01.m3u8',
                        isPremium: false,
                        isLive: true,
                        quality: 'HD',
                        viewersCount: 15420,
                        rating: 4.8,
                        membershipType: 'free'
                    },
                    {
                        id: '2',
                        name: 'beIN Sports',
                        nameAr: 'بين سبورت',
                        description: 'قناة رياضية عالمية',
                        descriptionAr: 'قناة رياضية تقدم أهم المباريات والبطولات العالمية',
                        category: 'Sports',
                        imageUrl: 'https://images.unsplash.com/photo-1431324155629-1a6deb1dec8d?w=400&h=300&fit=crop',
                        url: 'https://example.com/beinsports1.m3u8',
                        isPremium: true,
                        isLive: true,
                        quality: 'FHD',
                        viewersCount: 25600,
                        rating: 4.9,
                        membershipType: 'premium'
                    },
                    {
                        id: '3',
                        name: 'MBC Egypt',
                        nameAr: 'MBC مصر',
                        description: 'قناة ترفيهية مصرية',
                        descriptionAr: 'قناة ترفيهية تقدم أفضل البرامج والمسلسلات المصرية',
                        category: 'Entertainment',
                        imageUrl: 'https://images.unsplash.com/photo-1522869635100-9f4c5e86aa37?w=400&h=300&fit=crop',
                        url: 'https://shls-mbcmasr-prod-dub.shahid.net/out/v1/d5036cabf11e45bf9d0db410ca135c18/index.m3u8',
                        isPremium: false,
                        isLive: true,
                        quality: 'HD',
                        viewersCount: 8900,
                        rating: 4.5,
                        membershipType: 'free'
                    },
                    {
                        id: '4',
                        name: 'National Geographic',
                        nameAr: 'ناشيونال جيوغرافيك',
                        description: 'قناة وثائقية',
                        descriptionAr: 'قناة وثائقية تقدم أفضل البرامج العلمية والطبيعية',
                        category: 'Documentary',
                        imageUrl: 'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=400&h=300&fit=crop',
                        url: 'https://example.com/natgeo.m3u8',
                        isPremium: false,
                        isLive: true,
                        quality: 'HD',
                        viewersCount: 5400,
                        rating: 4.6,
                        membershipType: 'free'
                    },
                    {
                        id: '5',
                        name: 'Spacetoon',
                        nameAr: 'سبيستون',
                        description: 'قناة أطفال',
                        descriptionAr: 'قناة مخصصة لبرامج وأفلام الأطفال',
                        category: 'Kids',
                        imageUrl: 'https://images.unsplash.com/photo-1587654780291-39c9404d746b?w=400&h=300&fit=crop',
                        url: 'https://example.com/spacetoon.m3u8',
                        isPremium: false,
                        isLive: true,
                        quality: 'HD',
                        viewersCount: 3200,
                        rating: 4.3,
                        membershipType: 'free'
                    }
                ];
            }

            loadMockCategories() {
                this.categories = [
                    { id: '1', name: 'News', nameAr: 'أخبار', icon: 'fas fa-newspaper', isActive: true },
                    { id: '2', name: 'Sports', nameAr: 'رياضة', icon: 'fas fa-futbol', isActive: true },
                    { id: '3', name: 'Entertainment', nameAr: 'ترفيه', icon: 'fas fa-masks-theater', isActive: true },
                    { id: '4', name: 'Documentary', nameAr: 'وثائقي', icon: 'fas fa-film', isActive: true },
                    { id: '5', name: 'Kids', nameAr: 'أطفال', icon: 'fas fa-child', isActive: true },
                    { id: '6', name: 'Music', nameAr: 'موسيقى', icon: 'fas fa-music', isActive: true }
                ];
            }

            loadMockAds() {
                this.ads = [
                    {
                        id: '1',
                        title: 'اشتراك مميز في TvNa',
                        description: 'احصل على وصول كامل لجميع القنوات المميزة مع جودة 4K',
                        imageUrl: 'https://images.unsplash.com/photo-1611162617474-5b21e879e113?w=800&h=400&fit=crop',
                        link: '#premium',
                        isActive: true
                    },
                    {
                        id: '2',
                        title: 'أحدث الأخبار الرياضية',
                        description: 'تابع أحدث الأخبار الرياضية والمباريات المباشرة',
                        imageUrl: 'https://images.unsplash.com/photo-1431324155629-1a6deb1dec8d?w=800&h=400&fit=crop',
                        link: '#sports',
                        isActive: true
                    },
                    {
                        id: '3',
                        title: 'أحدث البرامج الترفيهية',
                        description: 'شاهد أحدث البرامج والمسلسلات العربية والعالمية',
                        imageUrl: 'https://images.unsplash.com/photo-1489599809194-4066b6b60934?w=800&h=400&fit=crop',
                        link: '#entertainment',
                        isActive: true
                    }
                ];
            }
            
            checkUserSession() {
                const savedUser = localStorage.getItem('tvna_user');
                if (savedUser) {
                    this.currentUser = JSON.parse(savedUser);
                    this.updateUserUI();
                    this.loadUserFavorites();
                }
            }
            
            hideLoader() {
                setTimeout(() => {
                    this.elements.pageLoader.classList.add('hidden');
                    setTimeout(() => {
                        this.elements.pageLoader.style.display = 'none';
                    }, 500);
                }, 2000);
            }
            
            animateElements() {
                // Add animation classes to elements as they come into view
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('fade-in');
                        }
                    });
                });
                
                document.querySelectorAll('.channel-card, .stat-card, .section').forEach(el => {
                    observer.observe(el);
                });
            }
            
            showLoginModal() {
                this.elements.loginModal.classList.add('show');
                document.body.style.overflow = 'hidden';
            }
            
            hideLoginModal() {
                this.elements.loginModal.classList.remove('show');
                document.body.style.overflow = 'auto';
            }
            
            async handleLogin() {
                const emailOrUsername = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                if (!emailOrUsername || !password) {
                    this.showToast('يرجى ملء جميع الحقول', 'error');
                    return;
                }
                
                // Show loading state
                this.elements.submitLogin.innerHTML = '<i class="fas fa-spinner fa-spin"></i> جاري تسجيل الدخول...';
                this.elements.submitLogin.disabled = true;
                
                try {
                    const user = await this.authenticateUser(emailOrUsername, password);
                    
                    if (user) {
                        this.currentUser = user;
                        localStorage.setItem('tvna_user', JSON.stringify(this.currentUser));
                        this.updateUserUI();
                        this.hideLoginModal();
                        this.showToast(`مرحباً ${this.currentUser.username}!`, 'success');
                        
                        // Load user favorites
                        await this.loadUserFavorites();
                        
                        // Reset form
                        document.getElementById('email').value = '';
                        document.getElementById('password').value = '';
                    } else {
                        this.showToast('اسم المستخدم أو كلمة المرور غير صحيحة', 'error');
                    }
                } catch (error) {
                    console.error('Login error:', error);
                    this.showToast('خطأ في تسجيل الدخول', 'error');
                }
                
                // Reset button
                this.elements.submitLogin.innerHTML = 'دخول';
                this.elements.submitLogin.disabled = false;
            }
            
            updateUserUI() {
                if (this.currentUser) {
                    document.getElementById('welcomeTitle').textContent = `مرحباً ${this.currentUser.username} في TvNa`;
                    document.getElementById('welcomeSubtitle').textContent = 'استمتع الآن بأفضل القنوات المحلية والعالمية';
                    
                    this.elements.loginBtn.innerHTML = this.currentUser.avatar 
                        ? `<img src="${this.currentUser.avatar}" alt="avatar" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">` 
                        : `<i class="fas fa-user-circle"></i>`;
                    this.elements.loginBtn.classList.add('logged-in');
                    this.elements.loginBtn.title = `مرحباً ${this.currentUser.username}`;
                    
                    // Add logout functionality
                    this.elements.loginBtn.onclick = () => this.showUserMenu();
                }
            }
            
            showUserMenu() {
                const menu = document.createElement('div');
                menu.className = 'user-menu glass-bg rounded-xl';
                menu.style.cssText = `
                    position: absolute;
                    top: 60px;
                    right: 20px;
                    min-width: 200px;
                    padding: 1rem;
                    z-index: 2000;
                    backdrop-filter: blur(20px);
                `;
                
                menu.innerHTML = `
                    <div class="user-menu-header" style="margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <div style="font-weight: 700;">${this.currentUser.username}</div>
                        <div style="font-size: 0.8rem; opacity: 0.7;">${this.currentUser.email}</div>
                        ${this.currentUser.isPremium ? '<div class="premium-badge" style="background: var(--warning); padding: 0.2rem 0.5rem; border-radius: 20px; font-size: 0.7rem; margin-top: 0.5rem; display: inline-block;">عضو مميز</div>' : ''}
                    </div>
                    <div class="user-menu-item" style="padding: 0.5rem; cursor: pointer; border-radius: 8px; transition: all 0.3s ease;" onclick="this.showProfile()">
                        <i class="fas fa-user"></i> الملف الشخصي
                    </div>
                    <div class="user-menu-item" style="padding: 0.5rem; cursor: pointer; border-radius: 8px; transition: all 0.3s ease;" onclick="this.showSettings()">
                        <i class="fas fa-cog"></i> الإعدادات
                    </div>
                    <div class="user-menu-item" style="padding: 0.5rem; cursor: pointer; border-radius: 8px; transition: all 0.3s ease;" onclick="tvnaApp.logout()">
                        <i class="fas fa-sign-out-alt"></i> تسجيل الخروج
                    </div>
                `;
                
                document.body.appendChild(menu);
                
                // Add click outside to close
                setTimeout(() => {
                    document.addEventListener('click', function closeMenu(e) {
                        if (!menu.contains(e.target)) {
                            menu.remove();
                            document.removeEventListener('click', closeMenu);
                        }
                    });
                }, 100);
                
                // Add menu item hover effects
                menu.querySelectorAll('.user-menu-item').forEach(item => {
                    item.addEventListener('mouseenter', () => {
                        item.style.background = 'rgba(67, 97, 238, 0.2)';
                    });
                    item.addEventListener('mouseleave', () => {
                        item.style.background = 'transparent';
                    });
                });
            }
            
            logout() {
                localStorage.removeItem('tvna_user');
                this.currentUser = null;
                this.elements.loginBtn.innerHTML = '<i class="fas fa-user"></i>';
                this.elements.loginBtn.classList.remove('logged-in');
                this.elements.loginBtn.onclick = () => this.showLoginModal();
                document.getElementById('welcomeTitle').textContent = 'مرحباً بك في TvNa';
                document.getElementById('welcomeSubtitle').textContent = 'استمتع بأفضل تجربة مشاهدة مع القنوات المحلية والعالمية';
                this.showToast('تم تسجيل الخروج بنجاح', 'success');
                
                // Clear favorites if user logged out
                this.favorites = [];
                this.saveFavoritesToStorage();
                this.updateStats();
                if (this.currentTab === 'favorites') {
                    this.renderFavorites();
                }
            }
            
            toggleSearch() {
                const input = this.elements.searchInput;
                const isActive = input.classList.contains('active');
                
                if (isActive) {
                    input.classList.remove('active');
                    input.blur();
                    this.hideSearchResults();
                } else {
                    input.classList.add('active');
                    input.focus();
                }
            }
            
            handleSearch(query) {
                this.currentFilters.search = query.toLowerCase();
                
                if (query.length === 0) {
                    this.hideSearchResults();
                    this.filterChannels();
                    return;
                }
                
                const results = this.channels.filter(channel => 
                    channel.nameAr.toLowerCase().includes(query) ||
                    channel.name.toLowerCase().includes(query) ||
                    channel.category.toLowerCase().includes(query)
                );
                
                this.showSearchResults(results);
                this.filterChannels();
            }
            
            showSearchResults(results = []) {
                const container = this.elements.searchResults;
                
                if (results.length === 0 && this.currentFilters.search.length > 0) {
                    container.innerHTML = `
                        <div class="search-result-item">
                            <div class="search-result-icon">
                                <i class="fas fa-search"></i>
                            </div>
                            <div class="search-result-content">
                                <div class="search-result-title">لا توجد نتائج</div>
                                <div class="search-result-category">جرب كلمات بحث أخرى</div>
                            </div>
                        </div>
                    `;
                } else if (results.length > 0) {
                    container.innerHTML = results.slice(0, 5).map(channel => `
                        <div class="search-result-item" onclick="tvnaApp.selectSearchResult('${channel.id}')">
                            <div class="search-result-icon">
                                <i class="fas fa-tv"></i>
                            </div>
                            <div class="search-result-content">
                                <div class="search-result-title">${channel.nameAr}</div>
                                <div class="search-result-category">${channel.category}</div>
                            </div>
                        </div>
                    `).join('');
                    
                    if (results.length > 5) {
                        container.innerHTML += `
                            <div class="search-result-item" onclick="tvnaApp.showAllSearchResults()">
                                <div class="search-result-icon">
                                    <i class="fas fa-ellipsis-h"></i>
                                </div>
                                <div class="search-result-content">
                                    <div class="search-result-title">عرض جميع النتائج (${results.length})</div>
                                    <div class="search-result-category">انقر لعرض الكل</div>
                                </div>
                            </div>
                        `;
                    }
                }
                
                container.style.display = 'block';
            }
            
            hideSearchResults() {
                this.elements.searchResults.style.display = 'none';
            }
            
            selectSearchResult(channelId) {
                const channel = this.channels.find(c => c.id === channelId);
                if (channel) {
                    this.playChannel(channel);
                    this.hideSearchResults();
                    this.elements.searchInput.value = '';
                    this.elements.searchInput.classList.remove('active');
                }
            }
            
            showAllSearchResults() {
                this.showTab('channels');
                this.hideSearchResults();
                this.elements.searchInput.classList.remove('active');
            }
            
            toggleTheme() {
                document.body.classList.toggle('dark-mode');
                const icon = this.elements.themeBtn.querySelector('i');
                
                if (document.body.classList.contains('dark-mode')) {
                    icon.classList.remove('fa-moon');
                    icon.classList.add('fa-sun');
                    localStorage.setItem('tvna_theme', 'dark');
                } else {
                    icon.classList.remove('fa-sun');
                    icon.classList.add('fa-moon');
                    localStorage.setItem('tvna_theme', 'light');
                }
                
                this.showToast('تم تغيير المظهر', 'success');
            }
            
            showTab(tabName) {
                // Hide all tabs
                this.elements.tabContents.forEach(tab => {
                    tab.classList.remove('active');
                });
                
                // Remove active class from all nav links
                this.elements.navLinks.forEach(link => {
                    link.classList.remove('active');
                });
                
                // Show selected tab
                const targetTab = document.getElementById(`${tabName}Tab`);
                if (targetTab) {
                    targetTab.classList.add('active');
                    this.currentTab = tabName;
                }
                
                // Add active class to selected nav link
                const activeLink = document.querySelector(`.nav-link[data-tab="${tabName}"]`);
                if (activeLink) {
                    activeLink.classList.add('active');
                }
                
                // Load data for specific tabs
                switch (tabName) {
                    case 'categories':
                        this.renderCategories();
                        break;
                    case 'favorites':
                        this.renderFavorites();
                        break;
                    case 'news':
                        this.renderNews();
                        break;
                    case 'channels':
                        this.filterChannels();
                        break;
                }
                
                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
            
            updateStats() {
                document.getElementById('channelsCount').textContent = this.channels.length;
                document.getElementById('favoritesCount').textContent = this.favorites.length;
                // Removed usersCount update to prevent error
            }
            
            renderAds() {
                const container = document.getElementById('adsCarousel');
                if (!container) return;
                
                container.innerHTML = '';
                
                this.ads.forEach((ad, index) => {
                    const slide = document.createElement('div');
                    slide.className = `ad-slide ${index === 0 ? 'active' : ''}`;
                    slide.style.backgroundImage = `url('${ad.imageUrl}')`;
                    slide.innerHTML = `
                        <div class="ad-content">
                            <div class="ad-badge">مميز</div>
                            <h3 class="ad-title">${ad.title}</h3>
                            <p class="ad-desc">${ad.description}</p>
                            ${ad.link ? `<a href="${ad.link}" class="ad-link">
                                <span>المزيد</span>
                                <i class="fas fa-arrow-left"></i>
                            </a>` : ''}
                        </div>
                    `;
                    container.appendChild(slide);
                });
                
                // Add carousel indicators
                const indicators = document.createElement('div');
                indicators.className = 'carousel-indicators';
                this.ads.forEach((_, index) => {
                    const indicator = document.createElement('div');
                    indicator.className = `carousel-indicator ${index === 0 ? 'active' : ''}`;
                    indicator.onclick = () => this.goToSlide(index);
                    indicators.appendChild(indicator);
                });
                container.appendChild(indicators);
                
                // Add navigation arrows
                const prevBtn = document.createElement('div');
                prevBtn.className = 'carousel-nav prev';
                prevBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
                prevBtn.onclick = () => this.previousSlide();
                
                const nextBtn = document.createElement('div');
                nextBtn.className = 'carousel-nav next';
                nextBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
                nextBtn.onclick = () => this.nextSlide();
                
                container.appendChild(prevBtn);
                container.appendChild(nextBtn);
                
                // Auto rotate
                this.startCarouselRotation();
            }
            
            startCarouselRotation() {
                this.carouselInterval = setInterval(() => {
                    this.nextSlide();
                }, 5000);
            }
            
            nextSlide() {
                const slides = document.querySelectorAll('.ad-slide');
                const indicators = document.querySelectorAll('.carousel-indicator');
                let currentIndex = 0;
                
                slides.forEach((slide, index) => {
                    if (slide.classList.contains('active')) {
                        currentIndex = index;
                    }
                });
                
                const nextIndex = (currentIndex + 1) % slides.length;
                this.goToSlide(nextIndex);
            }
            
            previousSlide() {
                const slides = document.querySelectorAll('.ad-slide');
                let currentIndex = 0;
                
                slides.forEach((slide, index) => {
                    if (slide.classList.contains('active')) {
                        currentIndex = index;
                    }
                });
                
                const prevIndex = currentIndex === 0 ? slides.length - 1 : currentIndex - 1;
                this.goToSlide(prevIndex);
            }
            
            goToSlide(index) {
                const slides = document.querySelectorAll('.ad-slide');
                const indicators = document.querySelectorAll('.carousel-indicator');
                
                slides.forEach((slide, i) => {
                    slide.classList.toggle('active', i === index);
                });
                
                indicators.forEach((indicator, i) => {
                    indicator.classList.toggle('active', i === index);
                });
            }
            
            renderFeaturedChannels() {
                const container = document.getElementById('featuredChannels');
                if (!container) return;
                
                const featured = this.channels.filter(c => c.isPremium).slice(0, 6);
                this.renderChannelsInContainer(container, featured);
            }
            
            renderAllChannels() {
                const container = document.getElementById('allChannels');
                if (!container) return;
                
                this.renderChannelsInContainer(container, this.channels);
            }
            
            renderChannelsInContainer(container, channels) {
                if (channels.length === 0) {
                    container.innerHTML = this.getEmptyState('لا توجد قنوات', 'جرب تغيير الفلاتر أو البحث');
                    return;
                }
                
                container.innerHTML = '';
                channels.forEach(channel => {
                    container.appendChild(this.createChannelCard(channel));
                });
            }
            
            createChannelCard(channel) {
                const card = document.createElement('div');
                card.className = 'channel-card fade-in';
                
                const isFavorite = this.favorites.some(f => f.id === channel.id);
                
                card.innerHTML = `
                    <div class="channel-header">
                        <img src="${channel.imageUrl}" class="channel-image" alt="${channel.nameAr}" loading="lazy">
                        <div class="channel-badges">
                            ${channel.isPremium ? '<div class="channel-badge premium"><i class="fas fa-crown"></i> مميز</div>' : ''}
                            ${channel.isLive ? '<div class="channel-badge live"><i class="fas fa-circle"></i> مباشر</div>' : ''}
                            ${channel.quality === 'HD' || channel.quality === 'FHD' || channel.quality === '4K' ? `<div class="channel-badge hd">${channel.quality}</div>` : ''}
                        </div>
                        <div class="channel-overlay">
                            <div class="play-overlay">
                                <i class="fas fa-play"></i>
                            </div>
                        </div>
                    </div>
                    <div class="channel-content">
                        <h3 class="channel-name">
                            <i class="fas fa-satellite"></i>
                            ${channel.nameAr}
                            <span class="channel-category">${this.getCategoryNameAr(channel.category)}</span>
                        </h3>
                        <p class="channel-desc">${channel.descriptionAr}</p>
                        <div class="channel-stats">
                            <div class="stat">
                                <i class="fas fa-eye"></i>
                                <span>${this.formatNumber(channel.viewersCount)} مشاهد</span>
                            </div>
                            <div class="stat">
                                <i class="fas fa-star"></i>
                                <span>${channel.rating.toFixed(1)}</span>
                            </div>
                        </div>
                        <div class="channel-actions">
                            <div class="channel-action-btn favorite ${isFavorite ? 'active' : ''}" 
                                 data-id="${channel.id}" data-action="favorite" 
                                 title="${isFavorite ? 'إزالة من المفضلة' : 'إضافة للمفضلة'}">
                                <i class="fas fa-heart"></i>
                            </div>
                            <div class="channel-action-btn" data-id="${channel.id}" data-action="share" title="مشاركة">
                                <i class="fas fa-share"></i>
                            </div>
                            <div class="channel-action-btn play-btn" data-id="${channel.id}" data-action="play">
                                <i class="fas fa-play"></i>
                                <span>مشاهدة</span>
                            </div>
                        </div>
                    </div>
                `;
                
                // Add event listeners
                card.querySelectorAll('.channel-action-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const channelId = btn.getAttribute('data-id');
                        const action = btn.getAttribute('data-action');
                        this.handleChannelAction(channelId, action);
                    });
                });
                
                // Add card click to play
                card.addEventListener('click', () => {
                    this.handleChannelAction(channel.id, 'play');
                });
                
                return card;
            }

            getCategoryNameAr(categoryName) {
                const category = this.categories.find(c => c.name === categoryName);
                return category ? category.nameAr : categoryName;
            }
            
            handleChannelAction(channelId, action) {
                const channel = this.channels.find(c => c.id === channelId);
                if (!channel) return;
                
                switch (action) {
                    case 'favorite':
                        this.toggleFavorite(channel);
                        break;
                    case 'share':
                        this.shareChannel(channel);
                        break;
                    case 'play':
                        this.playChannel(channel);
                        break;
                }
            }
            
            shareChannel(channel) {
                if (navigator.share) {
                    navigator.share({
                        title: channel.nameAr,
                        text: channel.descriptionAr,
                        url: window.location.href
                    });
                } else {
                    // Fallback to clipboard
                    const shareText = `${channel.nameAr} - ${channel.descriptionAr}\n${window.location.href}`;
                    navigator.clipboard.writeText(shareText).then(() => {
                        this.showToast('تم نسخ رابط القناة', 'success');
                    });
                }
            }
            
            playChannel(channel) {
                console.log('Attempting to play channel:', channel);
                console.log('Current user:', this.currentUser);
                
                // Check if user is logged in
                if (!this.currentUser) {
                    this.showLoginModal();
                    this.showToast('يجب تسجيل الدخول أولاً', 'warning');
                    return;
                }

                // Check if user account is active
                if (!this.currentUser.isActive) {
                    this.showToast('حسابك غير نشط، تواصل مع الإدارة', 'error');
                    return;
                }

                // Check user permissions for premium content
                if (channel.isPremium || channel.membershipType === 'premium') {
                    if (!this.currentUser.isPremium) {
                        this.showPremiumModal();
                        return;
                    }
                }
                
                // Check if user has access to this specific channel (for VIP users)
                if (this.currentUser.membershipType === 'vip' && 
                    this.currentUser.allowedChannels.length > 0 && 
                    !this.currentUser.allowedChannels.includes(channel.id)) {
                    this.showToast('ليس لديك صلاحية لمشاهدة هذه القناة', 'warning');
                    return;
                }
                
                this.showVideoPlayer(channel);
            }
            
            showVideoPlayer(channel) {
                this.elements.videoPlayer.classList.add('show');
                document.body.style.overflow = 'hidden';
                
                document.getElementById('playerTitle').textContent = channel.nameAr;
                document.getElementById('playerCategory').textContent = this.getCategoryNameAr(channel.category);
                
                // Initialize video player
                try {
                    if (Hls.isSupported()) {
                        const hls = new Hls();
                        hls.loadSource(channel.url);
                        hls.attachMedia(this.elements.playerElement);
                        hls.on(Hls.Events.MANIFEST_PARSED, () => {
                            this.elements.playerElement.play();
                        });
                    } else if (this.elements.playerElement.canPlayType('application/vnd.apple.mpegurl')) {
                        this.elements.playerElement.src = channel.url;
                        this.elements.playerElement.addEventListener('loadedmetadata', () => {
                            this.elements.playerElement.play();
                        });
                    } else {
                        // Fallback for demo
                        this.showToast('تعذر تشغيل القناة - هذا عرض تجريبي', 'error');
                        this.closeVideoPlayer();
                    }
                } catch (error) {
                    console.error('Error playing channel:', error);
                    this.showToast('تعذر تشغيل القناة', 'error');
                    this.closeVideoPlayer();
                }
            }
            
            closeVideoPlayer() {
                this.elements.videoPlayer.classList.remove('show');
                document.body.style.overflow = 'auto';
                
                if (this.elements.playerElement) {
                    this.elements.playerElement.pause();
                    this.elements.playerElement.src = '';
                }
            }
            
            toggleFullscreen() {
                if (document.fullscreenElement) {
                    document.exitFullscreen();
                } else {
                    this.elements.videoPlayer.requestFullscreen();
                }
            }
            
            toggleMute() {
                const player = this.elements.playerElement;
                player.muted = !player.muted;
                
                const icon = document.getElementById('playerVolume').querySelector('i');
                if (player.muted) {
                    icon.classList.remove('fa-volume-up');
                    icon.classList.add('fa-volume-mute');
                } else {
                    icon.classList.remove('fa-volume-mute');
                    icon.classList.add('fa-volume-up');
                }
            }
            
            renderCategories() {
                const container = document.getElementById('categoriesContent');
                if (!container) return;
                
                container.innerHTML = '';
                
                this.categories.forEach(category => {
                    const categoryChannels = this.channels.filter(c => c.category === category.name);
                    
                    const card = document.createElement('div');
                    card.className = 'channel-card fade-in';
                    card.innerHTML = `
                        <div class="channel-header">
                            <div style="background: var(--gradient-card); width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(20px);">
                                <i class="${category.icon}" style="font-size: 4rem; background: var(--premium); -webkit-background-clip: text; -webkit-text-fill-color: transparent;"></i>
                            </div>
                        </div>
                        <div class="channel-content">
                            <h3 class="channel-name">
                                <i class="${category.icon}"></i>
                                ${category.nameAr}
                            </h3>
                            <p class="channel-desc">${categoryChannels.length} قنوات متاحة</p>
                            <div class="channel-stats">
                                <div class="stat">
                                    <i class="fas fa-tv"></i>
                                    <span>${categoryChannels.length} قنوات</span>
                                </div>
                                <div class="stat">
                                    <i class="fas fa-users"></i>
                                    <span>${this.formatNumber(Math.floor(Math.random() * 10000) + 1000)} مشاهد</span>
                                </div>
                            </div>
                            <div class="channel-actions">
                                <div class="channel-action-btn play-btn" data-category="${category.name}">
                                    <i class="fas fa-eye"></i>
                                    <span>عرض القنوات</span>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    card.querySelector('.play-btn').addEventListener('click', () => {
                        this.showCategoryChannels(category.name);
                    });
                    
                    container.appendChild(card);
                });
            }
            
            showCategoryChannels(category) {
                this.currentFilters.category = category;
                this.showTab('channels');
                
                // Update filter dropdown
                document.getElementById('categoryFilter').value = category;
                this.filterChannels();
                
                // Scroll to channels section
                setTimeout(() => {
                    document.getElementById('allChannels').scrollIntoView({ 
                        behavior: 'smooth',
                        block: 'start'
                    });
                }, 100);
            }
            
            renderFavorites() {
                const container = document.getElementById('favoritesContent');
                if (!container) return;
                
                if (this.favorites.length === 0) {
                    container.innerHTML = this.getEmptyState(
                        'لا توجد قنوات مفضلة',
                        'أضف بعض القنوات إلى مفضلتك لتظهر هنا',
                        'fas fa-heart'
                    );
                    return;
                }
                
                this.renderChannelsInContainer(container, this.favorites);
            }
            
            renderNews() {
                const container = document.getElementById('newsContent');
                if (!container) return;
                
                const newsChannels = this.channels.filter(c => c.category === 'News' || c.category === 'Sports');
                this.renderChannelsInContainer(container, newsChannels);
            }
            
            populateFilters() {
                const categoryFilter = document.getElementById('categoryFilter');
                if (!categoryFilter) return;
                
                // Clear existing options except the first one
                categoryFilter.innerHTML = '<option value="">جميع التصنيفات</option>';
                
                // Add category options
                this.categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category.name;
                    option.textContent = category.nameAr;
                    categoryFilter.appendChild(option);
                });
            }
            
            filterChannels() {
                let filtered = [...this.channels];
                
                // Filter by category
                if (this.currentFilters.category) {
                    filtered = filtered.filter(c => c.category === this.currentFilters.category);
                }
                
                // Filter by quality
                if (this.currentFilters.quality) {
                    filtered = filtered.filter(c => c.quality === this.currentFilters.quality);
                }
                
                // Filter by search
                if (this.currentFilters.search) {
                    filtered = filtered.filter(c => 
                        c.nameAr.toLowerCase().includes(this.currentFilters.search) ||
                        c.name.toLowerCase().includes(this.currentFilters.search) ||
                        c.category.toLowerCase().includes(this.currentFilters.search)
                    );
                }
                
                // Sort channels
                this.sortChannelsArray(filtered);
                
                // Update UI
                this.renderChannelsInContainer(document.getElementById('allChannels'), filtered);
            }
            
            sortChannels() {
                this.filterChannels();
            }
            
            sortChannelsArray(channels) {
                channels.sort((a, b) => {
                    switch (this.currentSort) {
                        case 'name':
                            return a.nameAr.localeCompare(b.nameAr);
                        case 'popularity':
                            return b.viewersCount - a.viewersCount;
                        case 'rating':
                            return b.rating - a.rating;
                        default:
                            return 0;
                    }
                });
            }
            
            updateSortButtons() {
                document.querySelectorAll('.sort-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.getAttribute('data-sort') === this.currentSort);
                });
            }
            
            updateFavoriteButtons() {
                document.querySelectorAll('.channel-action-btn.favorite').forEach(btn => {
                    const channelId = btn.getAttribute('data-id');
                    const isFavorite = this.favorites.some(f => f.id === channelId);
                    btn.classList.toggle('active', isFavorite);
                    btn.title = isFavorite ? 'إزالة من المفضلة' : 'إضافة للمفضلة';
                });
            }
            
            updateView(viewType) {
                const grids = document.querySelectorAll('.channels-grid');
                grids.forEach(grid => {
                    if (viewType === 'list') {
                        grid.style.gridTemplateColumns = '1fr';
                        grid.querySelectorAll('.channel-card').forEach(card => {
                            card.style.display = 'flex';
                            card.style.height = 'auto';
                            const header = card.querySelector('.channel-header');
                            const content = card.querySelector('.channel-content');
                            if (header && content) {
                                header.style.width = '200px';
                                header.style.minWidth = '200px';
                                header.style.height = '120px';
                                content.style.flex = '1';
                            }
                        });
                    } else {
                        grid.style.gridTemplateColumns = 'repeat(auto-fill, minmax(320px, 1fr))';
                        grid.querySelectorAll('.channel-card').forEach(card => {
                            card.style.display = 'block';
                            card.style.height = 'auto';
                            const header = card.querySelector('.channel-header');
                            const content = card.querySelector('.channel-content');
                            if (header && content) {
                                header.style.width = '100%';
                                header.style.height = '200px';
                                content.style.flex = 'none';
                            }
                        });
                    }
                });
            }
            
            clearAllFavorites() {
                if (this.favorites.length === 0) {
                    this.showToast('لا توجد قنوات مفضلة لحذفها', 'warning');
                    return;
                }
                
                if (confirm('هل أنت متأكد من حذف جميع القنوات المفضلة؟')) {
                    this.favorites = [];
                    this.saveFavoritesToStorage();
                    this.updateStats();
                    this.updateFavoriteButtons();
                    this.renderFavorites();
                    this.showToast('تم حذف جميع القنوات المفضلة', 'success');
                }
            }
            
            showPremiumModal() {
                const modal = document.createElement('div');
                modal.className = 'modal show';
                modal.innerHTML = `
                    <div class="modal-content">
                        <div class="close-modal" onclick="this.parentElement.parentElement.remove(); document.body.style.overflow = 'auto';">
                            <i class="fas fa-times"></i>
                        </div>
                        <h2 class="modal-title">
                            <i class="fas fa-crown" style="color: var(--warning);"></i>
                            العضوية المميزة
                        </h2>
                        
                        <div style="text-align: center; margin-bottom: 2rem;">
                            <div style="font-size: 3rem; font-weight: 900; background: var(--premium); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                                1.500 د.ع 
                            </div>
                            <div style="opacity: 0.7;">شهرياً</div>
                        </div>
                        
                        <div style="margin-bottom: 2rem;">
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <i class="fas fa-check" style="color: var(--success);"></i>
                                <span>وصول كامل لجميع القنوات المميزة</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <i class="fas fa-check" style="color: var(--success);"></i>
                                <span>جودة 4K فائقة الوضوح</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <i class="fas fa-check" style="color: var(--success);"></i>
                                <span>مشاهدة بدون إعلانات</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <i class="fas fa-check" style="color: var(--success);"></i>
                                <span>تسجيل البرامج والمباريات</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <i class="fas fa-check" style="color: var(--success);"></i>
                                <span>دعم فني</span>
                            </div>
                        </div>
                        
                        <button class="modal-btn" onclick="tvnaApp.handlePremiumUpgrade(this)">
                            <i class="fas fa-crown"></i>
                            اشترك الآن
                        </button>
                        
                        <div class="modal-footer">
                            <p>يمكنك إلغاء الاشتراك في أي وقت</p>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                document.body.style.overflow = 'hidden';
            }
            
            handlePremiumUpgrade(button) {
                button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> جاري المعالجة...';
                button.disabled = true;
                
                setTimeout(() => {
                    if (this.currentUser) {
                        this.currentUser.isPremium = true;
                        this.currentUser.membershipType = 'premium';
                        localStorage.setItem('tvna_user', JSON.stringify(this.currentUser));
                        this.updateUserUI();
                    }
                    
                    document.querySelector('.modal.show').remove();
                    document.body.style.overflow = 'auto';
                    this.showToast('مرحباً في العضوية المميزة! 🎉', 'success');
                }, 2000);
            }
            
            handleNewsletterSubscription(e) {
                const email = e.target.querySelector('input').value;
                if (!this.isValidEmail(email)) {
                    this.showToast('يرجى إدخال بريد إلكتروني صحيح', 'error');
                    return;
                }
                
                const button = e.target.querySelector('button');
                const originalHTML = button.innerHTML;
                button.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                button.disabled = true;
                
                setTimeout(() => {
                    e.target.reset();
                    button.innerHTML = originalHTML;
                    button.disabled = false;
                    this.showToast('تم الاشتراك في النشرة البريدية بنجاح!', 'success');
                }, 1500);
            }
            
            showToast(message, type = 'info', duration = 3000) {
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                
                const icons = {
                    success: 'fas fa-check-circle',
                    error: 'fas fa-exclamation-circle',
                    warning: 'fas fa-exclamation-triangle',
                    info: 'fas fa-info-circle'
                };
                
                toast.innerHTML = `
                    <div class="toast-icon">
                        <i class="${icons[type] || icons.info}"></i>
                    </div>
                    <div class="toast-content">
                        <div class="toast-message">${message}</div>
                    </div>
                    <div class="toast-close">
                        <i class="fas fa-times"></i>
                    </div>
                `;
                
                this.elements.toastContainer.appendChild(toast);
                
                // Show toast
                setTimeout(() => toast.classList.add('show'), 100);
                
                // Add close functionality
                toast.querySelector('.toast-close').addEventListener('click', () => {
                    this.removeToast(toast);
                });
                
                // Auto remove
                setTimeout(() => {
                    this.removeToast(toast);
                }, duration);
            }
            
            removeToast(toast) {
                toast.classList.remove('show');
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }
            
            getEmptyState(title, message, icon = 'fas fa-tv') {
                return `
                    <div class="empty-state">
                        <div class="empty-state-icon">
                            <i class="${icon}"></i>
                        </div>
                        <div class="empty-state-title">${title}</div>
                        <div class="empty-state-message">${message}</div>
                    </div>
                `;
            }
            
            loadFavoritesFromStorage() {
                try {
                    const saved = localStorage.getItem('tvna_favorites');
                    return saved ? JSON.parse(saved) : [];
                } catch (error) {
                    console.error('Error loading favorites:', error);
                    return [];
                }
            }
            
            saveFavoritesToStorage() {
                try {
                    localStorage.setItem('tvna_favorites', JSON.stringify(this.favorites));
                } catch (error) {
                    console.error('Error saving favorites:', error);
                }
            }
            
            formatNumber(num) {
                if (num >= 1000000) {
                    return (num / 1000000).toFixed(1) + 'M';
                } else if (num >= 1000) {
                    return (num / 1000).toFixed(1) + 'K';
                }
                return num.toString();
            }
            
            isValidEmail(email) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return emailRegex.test(email);
            }
        }
        
        // Initialize the application
        let tvnaApp;
        document.addEventListener('DOMContentLoaded', () => {
            tvnaApp = new TvNaApp();
        });
        
        // Global functions for inline event handlers
        window.tvnaApp = {
            selectSearchResult: (id) => tvnaApp.selectSearchResult(id),
            showAllSearchResults: () => tvnaApp.showAllSearchResults(),
            handlePremiumUpgrade: (btn) => tvnaApp.handlePremiumUpgrade(btn),
            logout: () => tvnaApp.logout()
        };
    </script>
</body>
</html>
